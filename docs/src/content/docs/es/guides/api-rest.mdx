---
title: API REST
description: Uso del API vía HTTP con fetch, opciones de self‑hosting y ejemplos en varios lenguajes.
---

import { Card, CardGrid, LinkButton } from '@astrojs/starlight/components';

## ¿Qué es esta API?

- Expone un endpoint HTTP para generar PDFs a partir de un template React (TSX) y un objeto de datos.
- Devuelve un JSON con un campo `data.pdf` que contiene el PDF en base64.
- Puede consumirse desde cualquier lenguaje capaz de hacer peticiones HTTP.

## Endpoints disponibles

- Cloud (Self‑hosting gestionado): `https://react-pdf-levelup.nimbux.cloud/api`
- Auto‑hospedado (Self‑hosting propio): descarga el paquete desde `https://genarogg.github.io/react-pdf-levelup/public/api.zip` y despliega tu servidor. El endpoint expuesto es `/api/pdf`.

### Copiar endpoints rápidos

```text
https://react-pdf-levelup.nimbux.cloud/api
```

```text
https://genarogg.github.io/react-pdf-levelup/public/api.zip
```
<CardGrid>
  <Card title="Cloud" icon="cloud-download">
    Ideal para empezar rápido. Solo realiza un POST al endpoint con tu template en base64 y los datos.
  </Card>
  <Card title="Auto‑hospedado" icon="laptop">
    Descarga el paquete, descomprímelo y despliega en tu infraestructura (VM, contenedor, PaaS). Ofrece control total.
  </Card>
</CardGrid>

## Formato de solicitud

- Método: `POST`
- Headers: `Content-Type: application/json`
- Body:

```json
{
  "template": "<TSX_EN_BASE64>",
  "data": { "campo": "valor" }
}
```

## Consideraciones sobre Fuentes

### Registro de Fuentes Personalizadas

Si tu template utiliza fuentes personalizadas, debes registrarlas usando `Font.register`.
**IMPORTANTE**: La API no puede acceder a archivos locales. Las fuentes deben cargarse desde **URLs remotas absolutas** (https://...).

```ts
Font.register({
  family: "Lobster",
  fonts: [
    {
      src: "https://genarogg.github.io/react-pdf-levelup/public/font/Lobster-Regular.ttf",
      fontWeight: "normal",
    },
  ],
});
```

### Fuentes por defecto

Las siguientes fuentes están disponibles sin necesidad de registro:
`Courier`, `Courier-Bold`, `Courier-Oblique`, `Courier-BoldOblique`, `Helvetica`, `Helvetica-Bold`, `Helvetica-Oblique`, `Helvetica-BoldOblique`, `Times-Roman`, `Times-Bold`, `Times-Italic`, `Times-BoldItalic`.

## Consideraciones con Imágenes

### Carga y acceso

La API no puede acceder a archivos locales. Todas las imágenes utilizadas en un template deben referenciarse mediante **URLs remotas absolutas** (https://...). Evita rutas relativas o archivos locales en el paquete del cliente, ya que el servicio de renderizado no podrá resolverlos.

Ejemplo de uso dentro de un template:

```tsx
import { Image } from '@react-pdf-levelup/core';

const MyTemplate = ({ data }) => (
  <Layout>
    <Image
      src="https://genarogg.github.io/react-pdf-levelup/public/img/logo/logo.png"
      style={{ width: 120, height: 'auto' }}
    />
  </Layout>
);
```

### Formatos y recomendaciones

- Prefiere `JPEG` para fotografías (mejor compresión) y `PNG` para imágenes con transparencia o gráficos.
- Evita imágenes excesivamente grandes; redimensiona y optimiza (herramientas de compresión) antes de servirlas.
- Los data URLs (base64) funcionan técnicamente, pero aumentan mucho el tamaño de la carga útil — **no es recomendable para imágenes grandes.**

### CORS y accesibilidad

El servidor remoto que aloja las imágenes debe permitir el acceso desde el servicio de renderizado. Asegúrate de que el recurso esté públicamente accesible (sin autenticación) y no bloquee peticiones por CORS o IP. Si necesitas imágenes protegidas, utiliza URLs con tokens de acceso válidos y con tiempo de expiración adecuado.

### SVG

Los SVG pueden funcionar, pero comprueba que estén bien formateados y no incluyan referencias locales ni scripts. En ocasiones es preferible rasterizarlos a PNG si el renderizado no es consistente.

Si quieres, puedo añadir ejemplos visuales de antes/después (optimización) o instrucciones para servir imágenes desde GitHub Pages / CDN.

## Respuesta

```json
{
  "data": {
    "pdf": "<PDF_EN_BASE64>"
  }
}
```

## Ejemplo completo con Node.js (fetch)

Este ejemplo lee un template `.tsx`, lo convierte a base64, envía la petición al API y guarda el PDF.

```ts
import fs from "fs";
import path from "path";

type ApiResponse = {
  data?: { pdf?: string }
}

const ENDPOINT_API = "https://react-pdf-levelup.nimbux.cloud/api";

const petition = async ({ template, data }: { template: string, data: any }): Promise<string> => {
  const templatePath = path.join(process.cwd(), "src", "useExample", template);
  const tsxCode = fs.readFileSync(templatePath, "utf-8");
  const templateBase64 = Buffer.from(tsxCode, "utf-8").toString("base64");

  const res = await fetch(ENDPOINT_API, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ template: templateBase64, data }),
  });

  if (!res.ok) {
    const txt = await res.text();
    throw new Error(`API error (${res.status}): ${txt}`);
  }

  const json = await res.json() as ApiResponse;
  return json?.data?.pdf ?? "";
}

const savePDF = (resultBase64: string) => {
  const buffer = Buffer.from(resultBase64, "base64");
  const outputPath = path.join(process.cwd(), "src", "useExample", "example.pdf");
  fs.writeFileSync(outputPath, buffer);
  console.log("PDF guardado exitosamente en:", outputPath);
}

const generateAndSavePDF = async () => {
  try {
    const data = { nombre: "Genaro Gonzalez" };
    const resultBase64 = await petition({ template: "template.tsx", data });
    savePDF(resultBase64);
    console.log(resultBase64);
  } catch (error) {
    console.error("Error generating/saving PDF:", error);
  }
};

generateAndSavePDF();
```

## Ejemplos en otros lenguajes

Estos ejemplos muestran que el API puede usarse desde cualquier lenguaje.

### curl

```bash
curl -X POST https://react-pdf-levelup.nimbux.cloud/api \
  -H "Content-Type: application/json" \
  -d '{"template":"BASE64_TSX","data":{"nombre":"Genaro Gonzalez"}}'
```

### Python (requests)

```python
import requests
import base64

endpoint = "https://react-pdf-levelup.nimbux.cloud/api"
payload = {
    "template": "BASE64_TSX",
    "data": {"nombre": "Genaro Gonzalez"}
}

r = requests.post(endpoint, json=payload)
r.raise_for_status()
pdf_base64 = r.json().get("data", {}).get("pdf", "")

with open("example.pdf", "wb") as f:
    f.write(base64.b64decode(pdf_base64))
```

### C# (HttpClient)

```csharp
using System.Net.Http;
using System.Text;
using System.Text.Json;

var client = new HttpClient();
var endpoint = "https://react-pdf-levelup.nimbux.cloud/api";

var body = new {
  template = "BASE64_TSX",
  data = new { nombre = "Genaro Gonzalez" }
};

var json = JsonSerializer.Serialize(body);
var res = await client.PostAsync(endpoint, new StringContent(json, Encoding.UTF8, "application/json"));
res.EnsureSuccessStatusCode();
var content = await res.Content.ReadAsStringAsync();

using var doc = JsonDocument.Parse(content);
var base64 = doc.RootElement.GetProperty("data").GetProperty("pdf").GetString();
var bytes = Convert.FromBase64String(base64);
await File.WriteAllBytesAsync("example.pdf", bytes);
```

### Java (OkHttp)

```java
import okhttp3.*;

OkHttpClient client = new OkHttpClient();
String endpoint = "https://react-pdf-levelup.nimbux.cloud/api";
String json = "{\"template\":\"BASE64_TSX\",\"data\":{\"nombre\":\"Genaro Gonzalez\"}}";

RequestBody body = RequestBody.create(json, MediaType.parse("application/json"));
Request request = new Request.Builder().url(endpoint).post(body).build();

try (Response response = client.newCall(request).execute()) {
  if (!response.isSuccessful()) throw new RuntimeException("HTTP " + response.code());
  String res = response.body().string();
  // Parsear JSON para extraer data.pdf y decodificar base64
}
```

### PHP (cURL)

```php
<?php
$endpoint = 'https://react-pdf-levelup.nimbux.cloud/api';
$payload = [
  'template' => 'BASE64_TSX',
  'data' => ['nombre' => 'Genaro Gonzalez']
];

$ch = curl_init($endpoint);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_HTTPHEADER, ['Content-Type: application/json']);
curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($payload));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

$response = curl_exec($ch);
if ($response === false) {
  throw new Exception(curl_error($ch));
}
curl_close($ch);

$json = json_decode($response, true);
$pdfBase64 = $json['data']['pdf'] ?? '';
file_put_contents('example.pdf', base64_decode($pdfBase64));
```

## Self‑hosting propio

- Descarga `api.zip`: `https://genarogg.github.io/react-pdf-levelup/public/api.zip`.
- Descomprime y despliega en tu infraestructura (Node, Docker, PaaS).
- Expón el endpoint `/api/pdf` y apunta tu cliente a esa URL.
- La carga útil y respuesta siguen el mismo formato mostrado arriba.

<LinkButton href="https://genarogg.github.io/react-pdf-levelup/public/api.zip" icon="external" variant="primary" target="_blank" rel="noopener noreferrer">
  Descargar paquete API (ZIP)
</LinkButton>

{/* <LinkButton href="/docs/guides/backend-integration" icon="right-arrow" variant="primary">
  Ver guía de Integración Backend
</LinkButton> */}
